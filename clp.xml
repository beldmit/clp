<rfc category="exp" docName="Certificate Limitation Policy">
<front>
<title>Certificate Limitation Policy</title>
<author fullname="Dmitry Belyavskiy">
<address>
<email>beldmit@gmail.com</email>
</address>
</author>
<date/>
<area>sec</area>
<workgroup>spasm</workgroup>
<workgroup>saag</workgroup>
<abstract>
<t>The document provides a specification of the application-level trust model.
Being provided at the application level, the limitations of trust can be
distributed separately using cryptographically protected format instead of
hardcoding the checks into the application itself.</t>
</abstract>
</front>
<middle>

<section title="Introduction">
<t>Binary trust model standardized as a set of trusted anchors and CRLs/OCSP
services does not cover all corner cases in the modern crypto world. There is a
need in more differentiated limitations. Some of them are suggested by Google
when it limits the usage of  Symantecâ€™s certificates. The CRL profile does not
fit the purpose of such limitations. The CRLs are issued by the same CAs that
are subject to be limited. </t>

<t>Currently the set of CAs trusted by OS can be used for the validation purposes.
In case when a large enough CA becomes untrusted, it cannot be deleted from the
storage of trusted CAs because it may cause error of validation of many
certificates. The measures usually taken in such cases usually include
application-level limitation of certificates lifetimes, refuse to accept
EV-certificates in other way than DV, requirements of usage Certificate
Transparency, etc.</t>

<t>This document suggests a cryptographically protected format of description of
such limitations. This format can be used by applications that use system-wide
set of trust anchors for validating purposes or by applications with own wide
enough set of trusted anchors in case when the trust anchor for the entity
found misbehaving cannot be revoked.</t>

<t>Currently the only way to provide such limitations is hard coding in
application itself. Using of CLPs does not allow to completely avoid hard
coding but allows to hard code only the minimal set of rarely changing data,
such as the certificate to verify the signature and minimal date of issuance
(see below).</t>
</section>

<section title="Certificate Limitations Profile">
<t>A proposed syntax and overall structure of CLP is very similar to the one defined for CRLs.
TBD.</t>

<section title="CLP fields">
<t>TBD</t>
</section>
<section title="CLP extensions">
<t>TBD</t>
</section>
<section title="CLP signature">
<t>The key used for signing the CLP files should have a special Key Usage bit and/or
an Extended Key Usage value.</t>
</section>
<section title="CLP entry fields">
<t>Each entry in list contains the following fields:
<list>
<t>The issuer of the certificate with limited trust.</t>
<t>The serial of the certificate with limited trust.</t>
<t>The fingerprint of the certificate with limited trust (optional).</t>
<t>The flag indicating whether limitations are applied to the certificate
itself or to all of its descendants in the chain of trust.</t>
</list>
</t>
<t>
and a subset of the following limitations:
<list>
<t>maxPeriodStart (do not trust the certs issued after)</t>
<t>maxPeriodEnd (do not trust the certs after)</t>
<t>validityPeriod (take minimal value from "native" validity period and specified in the limitation file)</t>
<t>ignoreX509Extensions (e.g. EV)</t>
<t>requiredX509extensions (do not trust the certificates )</t>
</list>
</t>
<t>The limitations are identified by OIDs</t>
<section title="Limitations">
<section title="maxPeriodStart">
<t>When this limitation is present, no certificate matching the entry and
issued after the specified date should not be trusted</t>
</section>
<section title="maxPeriodEnd">
<t>When this limitation is present, no certificate matching the entry should be
trusted after the specified date.</t>
</section>
<section title="validityPeriod">
<t>When this limitation is present, no certificate matching the entry should be
treated as valid after specified period from its validFrom.</t>
</section>
<section title="ignoreX509Extensions">
<t>When this limitation is present, the extensions listed in this element
should be ignored for the matching certificate.</t>
</section>
<section title="requiredX509extensions">
<t>When this limitation is present, the extensions listed in this element
should be present for the matching certificate.</t>
</section>
</section>
</section>
</section>

<section title="ASN.1 notation">
<t>TBD</t>
</section>
<section title="Security considerations">
<t>In case when an application uses CLP, it is recommended to specify the minimal
date of issuing of the CLP document somewhere in code. It allows to avoid an
attack of CLP rollback when the stale version of CLP is used.</t>
</section>

<section title="IANA considerations"/>
<section title="Acknoledgements"/>
<section title="References">
<t>The current version of the document is available on GitHub
https://github.com/beldmit/clp
</t>
</section>
</middle>
</rfc>
